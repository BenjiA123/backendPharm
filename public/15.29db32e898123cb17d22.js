(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{"3tpA":function(e,s,t){"use strict";t.r(s),t.d(s,"MessageModule",(function(){return y}));var r=t("ofXK"),n=t("tyNb"),o=t("AytR"),a=t("jifJ"),c=t("fXoL"),i=t("kt0X"),m=t("FnMX"),g=t("tk/3");const u=o.a.apiUrl+"/chat";let l=(()=>{class e{constructor(e){this.http=e}getAllMessages(e,s){return this.http.post(""+u,{reciever:e,sender:s})}}return e.\u0275fac=function(s){return new(s||e)(c.Yb(g.b))},e.\u0275prov=c.Kb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var b=t("3Pt+"),d=t("kmnG"),f=t("qFsG");function _(e,s){if(1&e&&(c.Ub(0,"div",9),c.Oc(1),c.Tb()),2&e){const e=s.$implicit;c.Bb(1),c.Qc(" ",e.message," ")}}const p=Object(a.io)(o.a.baseUrl);let h=(()=>{class e{constructor(e,s,t,r){this.store=e,this.usersService=s,this.messageService=t,this.route=r,this.allMessages=[]}ngOnInit(){this.store.select("AuthState").subscribe(e=>{this.currentUser=e.currentUser}),this.route.params.subscribe(e=>{this.reciverUsername=e.username,this.usersService.getUserByUsername(this.reciverUsername).subscribe(e=>{this.reciverData=e.data.document,this.messageService.getAllMessages(this.reciverData._id,this.currentUser._id).subscribe(e=>{this.allMessages=e.chats})})})}sendMessage(e){""!=e.form.value.message&&this.sendSocketMessage({sender:this.currentUser._id,reciever:this.reciverData._id,message:e.form.value.message})}sendSocketMessage(e){p.emit("sendDirectMessage",e),p.on("messageResult",e=>{this.allMessages.push(e),console.log(this.allMessages)})}}return e.\u0275fac=function(s){return new(s||e)(c.Ob(i.h),c.Ob(m.a),c.Ob(l),c.Ob(n.a))},e.\u0275cmp=c.Ib({type:e,selectors:[["app-message-details"]],decls:12,vars:2,consts:[[1,"message_section"],[1,"message_top"],[1,"message_top_name"],["class","messageArray",4,"ngFor","ngForOf"],[1,"message_form"],[3,"submit"],["form","ngForm"],["ngModel","","matInput","","name","message","appearance","outline","placeholder","Type a message","type","text"],["type","submit"],[1,"messageArray"]],template:function(e,s){if(1&e){const e=c.Vb();c.Ub(0,"div",0),c.Ub(1,"div",1),c.Ub(2,"div",2),c.Oc(3),c.Tb(),c.Tb(),c.Mc(4,_,2,1,"div",3),c.Ub(5,"div",4),c.Ub(6,"form",5,6),c.ac("submit",(function(){c.Ec(e);const t=c.Bc(7);return s.sendMessage(t)})),c.Ub(8,"mat-form-field"),c.Pb(9,"input",7),c.Tb(),c.Ub(10,"button",8),c.Oc(11,"Arrow"),c.Tb(),c.Tb(),c.Tb(),c.Tb()}2&e&&(c.Bb(3),c.Pc(null==s.reciverData?null:s.reciverData.username),c.Bb(1),c.nc("ngForOf",s.allMessages))},directives:[r.m,b.t,b.m,b.n,d.c,b.b,f.a,b.l,b.o],styles:[".message_section[_ngcontent-%COMP%]{width:60%;height:80%;color:#faebd7;right:5%;top:15%;background-color:0;box-shadow:.05rem .1rem .3rem #000}.message_section[_ngcontent-%COMP%], .message_top[_ngcontent-%COMP%]{border-radius:2%;position:absolute}.message_top[_ngcontent-%COMP%]{height:10%;background-color:red;width:100%;top:0;color:#fff}.message_top_name[_ngcontent-%COMP%]{font-size:2.4rem;margin-left:2rem;text-transform:uppercase;margin-top:1rem}.message_form[_ngcontent-%COMP%]{background-color:red;border-radius:2%}.message_form[_ngcontent-%COMP%], .messageArray[_ngcontent-%COMP%]{height:10%;width:100%;position:absolute;bottom:0}.messageArray[_ngcontent-%COMP%]{background-color:green;right:0;color:#fff;font-size:70%}"]}),e})();const v=function(e){return["/message",e]};function M(e,s){if(1&e&&(c.Ub(0,"div",3),c.Ub(1,"div",4),c.Oc(2),c.Tb(),c.Tb()),2&e){const e=s.$implicit;c.nc("routerLink",c.sc(2,v,e.username)),c.Bb(2),c.Pc(e.username)}}const O=[{path:"",component:(()=>{class e{constructor(e){this.usersService=e}ngOnInit(){this.usersService.getAllUsers().subscribe(e=>{this.users=e.data.document})}}return e.\u0275fac=function(s){return new(s||e)(c.Ob(m.a))},e.\u0275cmp=c.Ib({type:e,selectors:[["app-message"]],decls:6,vars:1,consts:[[1,"message__card"],[1,"message__card__header"],["class","message__card__element",3,"routerLink",4,"ngFor","ngForOf"],[1,"message__card__element",3,"routerLink"],[1,"message__card__element__name"]],template:function(e,s){1&e&&(c.Ub(0,"div",0),c.Ub(1,"div",1),c.Oc(2,"Message"),c.Tb(),c.Mc(3,M,3,4,"div",2),c.Pb(4,"br"),c.Tb(),c.Pb(5,"router-outlet")),2&e&&(c.Bb(3),c.nc("ngForOf",s.users))},directives:[r.m,n.h,n.d],styles:[".message__card[_ngcontent-%COMP%]{left:4rem;top:7rem;height:auto;width:22.5%;background-color:#fff;position:absolute;color:brown;text-align:center;border-radius:.3rem;box-shadow:.1rem .2rem .6rem #0f0}.message__card__header[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace;color:#dc143c;font-weight:400;letter-spacing:.2rem;font-size:2rem;text-transform:uppercase;text-align:center;margin:1rem auto;padding-top:1rem}.message__card__element[_ngcontent-%COMP%]{width:70%;margin:.6rem 15%;height:3rem;border-radius:.6rem;background-color:grey;z-index:3;cursor:pointer}.message__card__element__name[_ngcontent-%COMP%]{text-align:left;color:#fff;text-transform:uppercase;margin:.8rem 1rem;float:left}"]}),e})(),children:[{path:":username",component:h}]}];let U=(()=>{class e{}return e.\u0275mod=c.Mb({type:e}),e.\u0275inj=c.Lb({factory:function(s){return new(s||e)},imports:[[n.g.forChild(O)],n.g]}),e})();var w=t("rhD1");let y=(()=>{class e{}return e.\u0275mod=c.Mb({type:e}),e.\u0275inj=c.Lb({factory:function(s){return new(s||e)},imports:[[r.c,U,w.a]]}),e})()}}]);